<div class="card">
  <p-toast></p-toast>
<p-table [value]="products" styleClass="p-datatable-striped" selectionMode="single" [(selection)]="selectedProduct"
         [paginator]="true"
         [rows]="10"
         editMode="row"
         [showCurrentPageReport]="true"
         currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
         [rowsPerPageOptions]="[10, 25, 50]"
         dataKey="date" [tableStyle]="{'min-width': '50rem'}">
  <ng-template pTemplate="caption">
    <div class="table-header">
<!--        <p-toolbar>-->
      <p-dropdown [options]="cities" [(ngModel)]="selectedCity" [showClear]="true" placeholder="Select a City"></p-dropdown>

      <p-calendar [(ngModel)]="from" dateFormat="dd/mm/yy"></p-calendar>
      <p-calendar [(ngModel)]="to" dateFormat="dd/mm/yy"></p-calendar>

      <p-button icon="pi pi-search" (click)="reload()"></p-button>
<!--      <p-button label="Submit" icon="pi pi-check" iconPos="right"></p-button>-->

      <p-button label="Submit" icon="pi pi-save" iconPos="right"></p-button>

<!--      </p-toolbar>-->
<!--      <span class="p-input-icon-left">-->
<!--                <i class="pi pi-search" (click)="reload()"></i>-->
<!--                <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Global Search" />-->
<!--            </span>-->
    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th style="width:15%"  pSortableColumn="date">Date<p-sortIcon field="date"></p-sortIcon></th>
      <th style="width:55%">Label</th>
      <th style="width:15%"  pSortableColumn="amount" >Amount<p-sortIcon field="amount"></p-sortIcon></th>
      <th style="width:15%">Sold</th>
      <th style="width:20%"></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-product let-editing="editing"  let-ri="rowIndex">
<!--    <tr [pSelectableRow]="product">-->
    <tr [pEditableRow]="product">
      <td>
        <p-cellEditor>
          <ng-template pTemplate="input">
<!--            <input pInputText type="text" [(ngModel)]="product.date">-->
                <p-calendar [(ngModel)]="product.date" dateFormat="dd/mm/yy"></p-calendar>
          </ng-template>
          <ng-template pTemplate="output">
            {{product.date | date: 'dd/MM/yyyy'}}
          </ng-template>
        </p-cellEditor>
      </td>

      <td>
        <p-cellEditor>
          <ng-template pTemplate="input">
            <input pInputText type="text" [(ngModel)]="product.label">
          </ng-template>
          <ng-template pTemplate="output">
            {{product.label}}
          </ng-template>
        </p-cellEditor>
      </td>

      <td>
        <p-cellEditor>
          <ng-template pTemplate="input">
            <input pInputText type="text" [(ngModel)]="product.amount">
          </ng-template>
          <ng-template pTemplate="output">
            {{product.amount}}
          </ng-template>
        </p-cellEditor>
      </td>



<!--      <td>{{ product.date  | date: 'dd/MM/yyyy' }}</td>-->
<!--      <td>{{ product.label }}</td>-->
<!--      <td>{{ product.amount }}</td>-->
      <td>
        <p-tag [value]="product.sold.toFixed(2)" [severity]="getSeverity(product.sold)"></p-tag>
      </td>
      <!--      <div [ngClass]="{'outofstock': product.quantity === 0, 'lowstock': (product.quantity > 0 && product.quantity < 10),'instock': product.quantity > 10}">-->
      <!--        {{product.quantity}}-->
      <!--      </div>-->


      <td>
        <div class="flex align-items-center justify-content-center gap-2">
          <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil" (click)="onRowEditInit(product)" class="p-button-rounded p-button-text"></button>
          <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check" (click)="onRowEditSave(product)" class="p-button-rounded p-button-text p-button-success mr-2"></button>
          <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times" (click)="onRowEditCancel(product, ri)" class="p-button-rounded p-button-text p-button-danger"></button>
        </div>
      </td>

    </tr>
  </ng-template>
</p-table>
</div>
